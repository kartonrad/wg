(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{210:function(e,t,r){e.exports=r.p+"static/media/loadbar.7041c03b.png"},267:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return Ae}));var n=r(3),i=r.n(n),o=r(176),a=r(22),c=r.n(a),s=r(11),l=r.n(s),d=(r(396),r(56)),u=r(7),f=r(17),b=r(43),j=r(4),g=r(44),h=r(0),p=r.n(h),O=r(420),m=r(167),y=r(414),x=r(408),v=r(36),w=r(77),S="https://wg-api.kartonrad.de",C="rgba(255,255,255,0.8)";function k(e){return null===e?null:e&&e.id&&e.extension?S+"/uploads/"+e.id+"."+e.extension:S+"/public/img/rejection.jpg"}var _=p.a.createContext(!1),P=p.a.createContext({wg:{name:"WG",description:"Loading...",profile_pic:null,header_pic:null},users:{}});function z(e,t,r){var n=p.a.useState(t),i=l()(n,2),o=i[0],a=i[1],s=p.a.useContext(_),d=l()(s,1)[0];return p.a.useEffect((function(){function n(){return(n=c()((function*(){var n={};d&&(n.headers={Authorization:"Bearer "+d.token});try{console.log("Fetching "+e);var i=yield fetch(S+e,n);if(!i.ok)return"undefined"!==typeof r&&a(r),void console.error("Failed fetch ["+e+"]: TEXT=> "+(yield i.text()));var o=yield i.json();typeof t===typeof o&&a(o)}catch(c){console.log(c),"undefined"!==typeof r&&a(r)}}))).apply(this,arguments)}e&&function(){n.apply(this,arguments)}()}),[e]),[o]}var D=r(48),E=(r(422),r(1));function W(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function I(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?W(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function A(e,t){var r=Number.parseFloat(t.amount),n=t.nr_unpaid_shares/t.nr_shares*r,i=r/t.nr_shares,o=0,a=1==t.my_share.paid||null==t.my_share.paid,c=e===t.creditor_id;return c?o+=n:o-=a?0:i,{my_gain:o,single_payment:i,amt:r,cost:t,am_creditor:c}}function N(e){var t=e.cost,r=Object(h.useContext)(_),n=l()(r,2),i=n[0],o=(n[1],A(i.user.id,t)),a=o.my_gain,c=(o.single_payment,o.amt),s=new Date(t.added_on).toDateString().substring(4,10),d={name:"Irgendwer"};return e.users&&e.users[t.creditor_id]&&(d=e.users[t.creditor_id]),Object(E.jsxs)(g.default,{style:I(I({},L.card),{},{marginLeft:10,padding:8,borderRadius:20},e.style),onPress:e.onPress,children:[Object(E.jsxs)(j.default,{style:I(I({},L.cardBody),{},{paddingBottom:0}),children:[Object(E.jsx)(f.default,{style:{fontSize:16,fontWeight:"bold"},children:t.name}),Object(E.jsxs)(j.default,{style:{flexDirection:"row",alignItems:"center"},children:[Object(E.jsx)(H,{style:{marginLeft:-25},imgSize:30,imgUrl:k(d.profile_pic)}),Object(E.jsxs)(f.default,{style:{color:"#6d6d6d"},children:["   ",d.name," zahlte: ",c.toFixed(2),"\u20ac"]})]})]}),Object(E.jsxs)(j.default,{children:[Object(E.jsx)(T,{amount:a,isWhite:!0}),Object(E.jsx)(f.default,{style:{textAlign:"right",color:"#6d6d6d"},children:s})]})]})}function F(e){var t=e.user||{},r=e.stat,n=Number.parseFloat(r.to_recieve),i=Number.parseFloat(r.to_pay);return Object(E.jsx)(B,I(I({},e),{},{imgUrl:k(t.profile_pic),imgSize:50,title:Object(E.jsx)(E.Fragment,{children:Object(E.jsx)(f.default,{numberOfLines:1,children:t.name})}),text:Object(E.jsxs)(j.default,{style:{flexDirection:"row"},children:[Object(E.jsx)(T,{amount:n,isWhite:!0}),Object(E.jsx)(f.default,{children:" + "}),Object(E.jsx)(T,{amount:-i,isWhite:!0})]}),children:Object(E.jsxs)(j.default,{style:{marginTop:0,marginRight:10},children:[Object(E.jsx)(f.default,{children:"total:"}),Object(E.jsx)(T,{amount:n-i,isWhite:!0})]})}))}function T(e){var t=e.amount.toFixed(2),r=t.startsWith("-"),n="0.00"==t;return r||n||(t="+"+t),Object(E.jsxs)(f.default,{style:I({color:r?"#fc5b05":"#00e04e",fontSize:18,fontWeight:"bold",textAlign:"center",backgroundColor:e.isWhite?"#ffffff":"#f4f4f4",borderColor:e.isWhite?"#f4f4f4":"#eaeaea",borderWidth:2,minWidth:70,borderRadius:10,padding:2,elevation:1},e.strikethrough||n?{textDecorationLine:"line-through",color:"grey"}:{}),children:[t,Object(E.jsx)(f.default,{style:{color:"#c1c1c1",fontWeight:"normal",fontSize:10},children:"\u20ac"})]})}function B(e){var t=e.imgSize||65;return Object(E.jsxs)(g.default,{style:I(I({},L.card),e.style),onPress:e.onPress,children:[Object(E.jsx)(H,{style:L.cardImgC,imgSize:t,imgUrl:e.imgUrl,children:e.icon&&Object(E.jsx)(j.default,{style:L.cardImgIcons,children:e.icon})}),Object(E.jsxs)(j.default,{style:L.cardBody,children:[Object(E.jsx)(f.default,{style:L.cardTitle,children:e.title}),Object(E.jsx)(f.default,{style:L.cardDesc,children:e.text})]}),e.children]})}function R(e){var t=e.user||{};return Object(E.jsx)(B,I(I({},e),{},{text:t.bio,imgUrl:k(t.profile_pic),title:Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)(f.default,{numberOfLines:1,children:t.name}),Object(E.jsxs)(f.default,{style:{fontSize:15,color:"rgba(0, 0, 0, 0.7)"},children:["\n","@",t.username]})]})}))}function H(e){var t=e.imgSize||65;return Object(E.jsxs)(j.default,{style:I(I({},e.style),{},{width:t,height:t}),children:[Object(E.jsx)(j.default,{style:I(I({},L.cardImgClip),e.styleRing),children:Object(E.jsx)(D.default,{source:{uri:e.imgUrl},height:t,style:{flex:1}})}),e.children]})}var L=u.default.create({card:{borderColor:"transparent",borderRadius:37.5,flexDirection:"row",backgroundColor:C,marginTop:5,marginLeft:20},cardBody:{flex:1,padding:10,paddingTop:5},cardTitle:{fontSize:18,fontWeight:"bold"},cardDesc:{fontSize:17,color:"#222",marginTop:10},cardImgC:{width:65,height:65,marginLeft:-20,shadowOpacity:1,marginTop:8},cardImgClip:{width:"100%",height:"100%",justifyContent:"center",backgroundColor:"rgba(41, 50, 135, 1)",borderRadius:50,overflow:"hidden",elevation:7},cardImgIcons:{position:"absolute",borderRadius:100,backgroundColor:"white",padding:3,right:0,top:0,marginTop:-3,marginRight:-7,aspectRatio:1,elevation:10}});function U(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function G(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?U(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var M=u.default.create({storeWrapper:{alignSelf:"flex-start",flexDirection:"column",alignSelf:"stretch"},storePanel:{backgroundColor:C,padding:10,paddingVertical:30},contactCard:{width:200,backgroundColor:C,borderRadius:37.5,padding:20,margin:10,overflow:"hidden"},newsWrapper:{marginTop:40,marginHorizontal:5},newsContainer:{backgroundColor:C},headerImg:{marginBottom:-30,zIndex:1,position:"absolute",bottom:0,left:0},bannerImg:{flex:1,minHeight:200,width:v.default.get("window").width,zIndex:1,backgroundColor:"rgba(41, 50, 135, 1)"},action_heading:{color:"white",borderRadius:40,backgroundColor:"#166b26",marginBottom:5,textAlign:"center",alignSelf:"center",fontSize:20,padding:5}});function J(e){var t=e.route.params||{},r=t.wg_url,n=t.wg,i=z(r&&!n?"/api/wg/"+r:n?null:"/api/my_wg",{name:"WG",description:"Loading...",profile_pic:null,header_pic:null},{name:"FEHLER!!",description:"Konnte auf diese WG nicht zugreifen!"}),a=l()(i,1)[0];console.log(c);var c=n||a,s=z(c&&c.id?"/api/wg/"+c.id+"/users":r||n?null:"/api/my_wg/users",[],[{name:"FEHLER!",username:"Halt"}]),d=l()(s,1)[0];return Object(E.jsx)(w.default,{blurRadius:5,source:{uri:k(c.header_pic)},style:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(37, 42, 82, 1)"},children:Object(E.jsxs)(o.ScrollView,{style:M.storeWrapper,children:[Object(E.jsx)(w.default,{source:{uri:k(c.header_pic)},style:M.bannerImg,children:Object(E.jsx)(H,{imgSize:100,style:M.headerImg,styleRing:{borderColor:C,borderWidth:5},imgUrl:k(c.profile_pic)})}),Object(E.jsxs)(j.default,{style:M.storePanel,children:[Object(E.jsx)(f.default,{style:{fontWeight:"bold",fontSize:23},children:c.name}),Object(E.jsx)(f.default,{style:{fontSize:17},children:c.description})]}),Object(E.jsxs)(j.default,{style:G(G({},M.newsWrapper),e.style),children:[!!e.onUserPress&&Object(E.jsx)(f.default,{style:M.action_heading,children:"Profil w\xe4hlen:"}),d.map((function(t){return Object(E.jsx)(R,{user:t,onPress:function(){return e.onUserPress?e.onUserPress(t):""}},t.id)}))]})]})})}var V=r(184),K=r(407),q=r(46),X=r(12);function Y(e){var t=Object(h.useState)(new Date(Date.now())),r=l()(t,2),n=r[0],i=r[1],o=Object(h.useState)("date"),a=l()(o,2),c=a[0],s=a[1],d=Object(h.useState)(!1),u=l()(d,2),b=u[0],O=u[1],m=function(t,r){var n=t.target.value.split(/[^1234567890]/g);console.log(n),i("date"==r?function(t){var r=new Date(t);return n.length>=3&&r.setFullYear(Number.parseInt(n[0]),Number.parseInt(n[1]),Number.parseInt(n[2])),e.onChange&&e.onChange(r),r}:function(t){var r=new Date(t);return n[0]&&r.setHours(Number.parseInt(n[0])),n[1]&&r.setMinutes(Number.parseInt(n[1])),n[2]&&r.setSeconds(Number.parseInt(n[2])),e.onChange&&e.onChange(r),r})},y=function(e){O(!0),s(e)},x=n.toTimeString().split(" "),v=x[0]||"lm:ao:yi",w=x[2]||"(UTC bro ka)";return x=v.substring(0,5)+" "+w,console.log("render show: "+b+", mode: "+c+", "+n.getFullYear()+"-"+n.getMonth()+"-"+n.getDate()+" "+n.getHours()+":"+n.getMinutes()),Object(E.jsxs)(j.default,{style:$.container,children:[Object(E.jsx)(f.default,{children:"Datum/Uhrzeit:"}),Object(E.jsxs)(j.default,{style:$.buttonwrapper,children:[Object(E.jsx)(g.default,{onPress:function(){y("date")},style:$.datebutton,children:Object(E.jsx)(f.default,{children:n.toDateString()})}),Object(E.jsx)(g.default,{onPress:function(){y("time")},style:$.datebutton,children:Object(E.jsx)(f.default,{children:x})})]}),b&&("date"==c?p.a.createElement("input",{type:"date",key:"date",onChange:function(e){return m(e,c)},value:n.getFullYear().toString().padStart(4,"0")+"-"+n.getMonth().toString().padStart(2,"0")+"-"+n.getDate().toString().padStart(2,"0")}):p.a.createElement("input",{type:"time",key:"time",onChange:function(e){return m(e,c)},value:n.getHours().toString().padStart(2,"0")+":"+n.getMinutes().toString().padStart(2,"0")}))]})}var $=u.default.create({buttonwrapper:{flexDirection:"row",borderColor:"#12912a",borderWidth:2,borderRadius:10,backgroundColor:"white"},datebutton:{flex:1,paddingVertical:10,borderRightColor:"#12912a",borderRightWidth:2,alignItems:"center"}}),Q=r(265),Z=r(127),ee=r(185),te=r(114),re="web"===X.default.OS?function(e,t,r,n){if(window.confirm([e,t].filter(Boolean).join("\n"))){var i=r.find((function(e){return"cancel"!==e.style}));i&&i.onPress()}else{var o=r.find((function(e){return"cancel"===e.style}));o&&o.onPress()}}:te.default.alert;function ne(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ie(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ne(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var oe=Object(K.default)(),ae=Object(x.default)(),ce=function(e){var t=Object(h.useContext)(P),r=(t.wg,t.users,Object(h.useState)(0)),n=l()(r,2),i=n[0],o=n[1];function a(){o((function(e){return e+1}))}return Object(E.jsxs)(ae.Navigator,{initialRouteName:"Finanzen",children:[Object(E.jsx)(ae.Screen,{name:"Finanzen",children:function(e){return Object(E.jsx)(se,ie({rerenderHandle:a},e),i)}}),Object(E.jsx)(ae.Screen,{name:"NewEntry",children:function(e){return Object(E.jsx)(pe,ie({rerenderHandle:a},e))}}),Object(E.jsx)(ae.Screen,{name:"ViewCost",component:Oe}),Object(E.jsx)(ae.Screen,{name:"HistoricBalanceCosts",component:fe})]})},se=function(e){var t=Object(h.useContext)(P),r=t.wg,n=t.users,i=Object(h.useContext)(_),o=l()(i,2),a=o[0],c=(o[1],z("/api/my_wg/costs/stats",[],[])),s=l()(c,1)[0];return Object(h.useEffect)((function(){var t=s.find((function(e){return e.user_id===a.user.id}));t&&e.navigation.setOptions({headerRight:function(e){return Object(E.jsx)(j.default,{style:{marginRight:10},children:Object(E.jsx)(T,{amount:t.to_recieve-t.to_pay})})}})}),[s]),Object(E.jsx)(w.default,{blurRadius:5,source:{uri:k(r.header_pic)},style:{flex:1,backgroundColor:"rgba(37, 42, 82, 1)"},children:Object(E.jsxs)(oe.Navigator,{initialRouteName:"Eintr\xe4ge",sceneContainerStyle:{backgroundColor:"transparent"},screenOptions:{tabBarIndicatorStyle:{backgroundColor:"#166b26"}},children:[Object(E.jsx)(oe.Screen,{name:"Eintr\xe4ge",children:function(t){return Object(E.jsx)(fe,ie(ie({},t),{},{rerenderHandle:e.rerenderHandle,canAddEntry:!0}))}}),Object(E.jsx)(oe.Screen,{name:"Balance",children:function(t){return Object(E.jsx)(de,ie(ie({},t),{},{rerenderHandle:e.rerenderHandle,users:n,stats:s}))}}),Object(E.jsx)(oe.Screen,{name:"Stats",component:le})]})})},le=function(e){var t=z("/api/my_wg/costs/over_time/week",[],[]),r=l()(t,1)[0],n=[{key:"i_recieved",data:[],color:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return"rgba(63, 252, 0, "+e+")"},withShadow:!1},{key:"i_paid",data:[],color:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return"rgba(252, 5, 5, "+Math.min(1,e+.5)+")"}},{key:"wg_spending",data:[],color:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return"rgba(252, 132, 5,"+Math.min(1,e+.5)+")"}},{key:"my_spending",data:[],color:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return"rgba(89, 78, 252, "+Math.min(1,e+.5)+")"}}],i=[],o=0,a=!1;if(r[0]&&r[0].week){for(var c=r[0].week,s=0;s<6;s++){var d=r[o];d&&d.week===c-s?(n[3].data.push(d.my_total_spending),n[2].data.push(d.total_unified_spending),n[1].data.push(d.i_paid),n[0].data.push(d.i_recieved),i.push(new Date(d.time_bucket).toDateString().substring(4,10)),o++):(n[0].data.push(0),n[1].data.push(0),n[2].data.push(0),n[3].data.push(0),i.push("KW"+String(c-s)))}i.reverse(),n[0].data.reverse(),n[1].data.reverse(),n[2].data.reverse(),n[3].data.reverse(),a=!0}return Object(E.jsxs)(q.default,{children:[Object(E.jsx)(Q.LineChart,{data:{labels:a?i:["loading"],datasets:a?n:[{data:[0]}]},width:v.default.get("window").width,height:400,yAxisLabel:"$",yAxisInterval:1,chartConfig:{backgroundColor:"#ffffff",backgroundGradientFrom:"#ffffff",backgroundGradientTo:"#ffffff",propsForBackgroundLines:{stroke:"#ccc"},decimalPlaces:2,color:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return"rgba(255, 255, 255, "+e+")"},labelColor:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return"rgba(0, 0, 0, "+e+")"},style:{borderRadius:16},propsForDots:{r:"6",strokeWidth:"2",stroke:"#42006b"},useShadowColorFromDataset:!0,fillShadowGradientFromOpacity:.4,fillShadowGradientToOpacity:0},bezier:!0,style:{marginVertical:8,borderRadius:16}}),Object(E.jsxs)(f.default,{style:{backgroundColor:C},children:["Ausgaben der letzten 6 Wochen:","\n","Enth\xe4lt bereits ausgeglichene Eink\xe4ufe","\n",Object(E.jsx)(f.default,{style:{color:"rgb(252, 132, 5)"},children:"Orange"})," f\xfcr die Gesamte Wg","\n",Object(E.jsx)(f.default,{style:{color:"rgb(89, 78, 252)"},children:"Blau"})," f\xfcr deine Ausgaben (Summe aller Anteile)","\n",Object(E.jsx)(f.default,{style:{color:"#4F7B30"},children:"Gr\xfcn"})," f\xfcr was du zur\xfcckbekommst/kamst ","\n  ","(F\xfcr Eink\xe4ufe der Woche)","\n",Object(E.jsx)(f.default,{style:{color:"rgb(252, 5, 5)"},children:"Rot"})," f\xfcr was du den WGlern zahlst/zahltest","\n  ","(F\xfcr Eink\xe4ufe der Woche)","\n"]}),Object(E.jsx)(f.default,{style:{backgroundColor:C},children:JSON.stringify(r,void 0,2)})]})},de=function(e){var t=z("/api/my_wg/costs/balance",[],[]),r=l()(t,1)[0],n=Object(h.useState)(!1),i=l()(n,2),o=i[0],a=i[1],s=Object(h.useState)(!1),u=l()(s,2),b=u[0],j=u[1],g=Object(h.useContext)(_),p=l()(g,2),O=p[0];p[1];function m(){return y.apply(this,arguments)}function y(){return(y=c()((function*(){j(!0);try{var t=yield fetch(S+"/api/my_wg/costs/balance",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+O.token}});if(t.ok)console.log("New Balance Successful"),e.rerenderHandle&&e.rerenderHandle();else{var r=yield t.text();a(r)}}catch(n){console.log(n),a(n)}j(!1)}))).apply(this,arguments)}return Object(E.jsxs)(q.default,{style:{flex:1},children:[Object(E.jsx)(f.default,{style:{fontSize:23,alignSelf:"stretch",padding:10,backgroundColor:C,fontWeight:"bold",textAlign:"center"},children:"Derzeitiger Unterschied"}),e.stats.map((function(t){var r=e.users[t.user_id];return Object(E.jsx)(F,{user:r,stat:t},r.id)})),Object(E.jsx)(d.default,{color:"#166b26",disabled:b,onPress:function(){re("Bist du sicher?","Klick OK um weiterzumachen.",[{text:"Abbrechen",onPress:function(){return console.log("Cancelled operation")},style:"cancel"},{text:"OK",onPress:m}])},title:"Abrechnen/Null setzen"}),o&&Object(E.jsx)(f.default,{children:JSON.stringify(o,void 0,2)}),Object(E.jsx)(f.default,{style:{fontSize:23,marginTop:20,alignSelf:"stretch",padding:10,backgroundColor:C,fontWeight:"bold",textAlign:"center"},children:"Historische Abrechnungen"}),r.map((function(t){return Object(E.jsx)(ue,{balance:t,navigation:e.navigation},t.id)}))]})},ue=function(e){var t=e.balance,r=Object(h.useContext)(P),n=(r.wg,r.users[String(t.initiator_id)]||{}),i=new Date(t.balanced_on),o=Number.parseFloat(t.i_paid),a=Number.parseFloat(t.i_recieved),c=Number.parseFloat(t.my_total_spending),s=Number.parseFloat(t.total_unified_spending);return Object(E.jsx)(B,{imgUrl:k(n.profile_pic),imgSize:40,title:Object(E.jsx)(E.Fragment,{children:Object(E.jsx)(f.default,{numberOfLines:1,children:i.toDateString()})}),text:Object(E.jsxs)(j.default,{children:[Object(E.jsxs)(f.default,{children:["Angeordnet von ",n.name]}),Object(E.jsxs)(j.default,{style:{flexDirection:"row",alignItems:"center"},children:[Object(E.jsx)(f.default,{children:"Ich gab "}),Object(E.jsx)(T,{amount:-c,isWhite:!0}),Object(E.jsx)(f.default,{children:" aus."})]}),Object(E.jsxs)(j.default,{style:{flexDirection:"row",alignItems:"center"},children:[Object(E.jsx)(f.default,{children:"Die WG gab "}),Object(E.jsx)(T,{amount:-s,isWhite:!0}),Object(E.jsx)(f.default,{children:" aus."})]})]}),onPress:function(){e.navigation&&e.navigation.push("HistoricBalanceCosts",{balanceId:t.id})},children:Object(E.jsxs)(j.default,{style:{marginTop:0,marginRight:10},children:[Object(E.jsx)(f.default,{children:"total:"}),Object(E.jsx)(T,{amount:a-o,isWhite:!0})]})})},fe=function(e){var t="/api/my_wg/costs";e.route&&e.route.params&&e.route.params.balanceId&&(t+="?balance="+e.route.params.balanceId);var r=z(t,[],[]),n=l()(r,1)[0],i=Object(h.useContext)(P),o=(i.wg,i.users);return Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)(q.default,{style:{flex:1},children:n.map((function(t){return Object(E.jsx)(N,{cost:t,users:o,onPress:function(){e.navigation.push("ViewCost",{cost:t,users:o})}},t.id)}))}),e.canAddEntry&&Object(E.jsx)(j.default,{style:{backgroundColor:C},children:Object(E.jsx)(g.default,{style:function(e){var t=e.pressed;return{backgroundColor:t?"#204227":"#166b26",paddingTop:t?10:5,paddingBottom:t?0:5,paddingStart:t?10:0,margin:5,marginHorizontal:15,borderRadius:10,borderWidth:8,borderColor:t?"#204227":"#166b26",borderTopColor:t?"#1d3522":"#12912a",borderStartColor:t?"#1d3522":"#12912a"}},android_ripple:{color:"transparent"},onPress:function(){e.navigation.push("NewEntry")},children:Object(E.jsx)(f.default,{style:{color:"white",textAlign:"center"},children:"Neuer Eintrag"})})})]})};function be(){return(be=c()((function*(e){return yield new Promise((function(t,r){var n=new XMLHttpRequest;n.onload=function(){t(n.response)},n.onerror=function(){r(new TypeError("Network request failed"))},n.responseType="blob",n.open("GET",e.uri,!0),n.send(null)}))}))).apply(this,arguments)}var je="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ge=function(){for(var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=t,n="",i=0,o=0,a=je;r.charAt(0|o)||(a="=",o%1);n+=a.charAt(63&i>>8-o%1*8)){if((e=r.charCodeAt(o+=3/4))>255)throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");i=i<<8|e}return n};function he(){return(he=c()((function*(e,t){var r=yield new Promise((function(r,n){var i=new XMLHttpRequest;i.open("GET",e,!0),i.setRequestHeader("Authorization","Bearer "+t),i.responseType="arraybuffer",i.onload=function(e){var t=i.response;t&&r([t,i.getResponseHeader("Content-Type")])},i.send(null)})),n=l()(r,2),i=n[0],o=n[1],a="data:"+o+";base64,",c="";return[].slice.call(new Uint8Array(i)).forEach((function(e){return c+=String.fromCharCode(e)})),[a+ge(c),o]}))).apply(this,arguments)}var pe=function(e){var t=Object(h.useContext)(P),r=(t.wg,t.users),n=Object(h.useContext)(_),o=l()(n,2),a=o[0],s=(o[1],Object(h.useState)("")),p=l()(s,2),O=p[0],m=p[1],y=Object(h.useState)(0),x=l()(y,2),v=x[0],w=x[1],C=Object(h.useState)(""),z=l()(C,2),W=z[0],I=z[1],A=Object(h.useState)("0.00"),N=l()(A,2),F=N[0],B=N[1],R=Object(h.useState)({}),L=l()(R,2),U=L[0],G=L[1],M=Object(h.useState)(new Date),J=l()(M,2),V=J[0],K=J[1],$=Object(h.useState)(!1),Q=l()($,2),ee=Q[0],te=Q[1];Object(h.useEffect)((function(){var e={};for(var t of Object.values(r))e[t.id]=a.user.id===t.id;G(e)}),[]),console.log(U);var re=Number.parseFloat(F),ne=Object.keys(U).length,oe=ne-(Object.keys(U).includes(String(a.user.id))?1:0),ae=function(){var t=c()((function*(){w(1);try{var t=JSON.stringify({name:W,amount:Number.parseFloat(F),added_on:V.toISOString(),debtors:Object.entries(U).map((function(e){return[Number.parseInt(e[0]),e[1]]}))});if(console.log(t),(n=yield fetch(S+"/api/my_wg/costs",{method:"POST",body:t,headers:{"Content-Type":"application/json",Authorization:"Bearer "+a.token}})).ok){var r=yield n.json();if(console.log("New Entry successfull",r),ee)try{w(2);var n,i=ee.uri.split("?")[0].split("/").pop()||"lmao.jpg",o=/\.(\w+)$/.exec(i),c=o?"image/"+o[1]:"image",s=new FormData;if("web"===X.default.OS){var l=yield function(e){return be.apply(this,arguments)}(ee);i.split(".").length<2&&(i+="."+l.type.split("/").pop()),s.append("receit",l,i)}else s.append("receit",{name:i,type:c,uri:ee.uri},i);if(!(n=yield fetch(S+"/api/my_wg/costs/"+r+"/receit",{method:"PUT",body:s,headers:{Authorization:"Bearer "+a.token}})).ok){w(0);var d=yield n.text();return console.log(d),void m(d)}}catch(d){return w(0),console.log(d),void m(d)}e.rerenderHandle(),e.navigation.goBack(),w(0)}else{var u=yield n.text();m(u),w(0)}}catch(d){m(d),w(0)}}));return function(){return t.apply(this,arguments)}}();return 2==v?Object(E.jsx)(j.default,{style:{flex:1,alignItems:"center",justifyContent:"center"},children:Object(E.jsxs)(f.default,{children:["Eintrag eingerichtet: ","\n"," Versuche nun Ahhang hochzuladen... ","\n"," Einen Augenblick.. Fenster nicht schlie\xdfen...",O&&"\nFEHLER: Naja verkackt- kann man nichts dran \xe4ndern, \n eintrag ist schon abgeschickt (schlechtes desin ik):\nSag mir mal bescheid wa:\n"+JSON.stringify(O)]})}):Object(E.jsxs)(q.default,{style:{margin:10},children:[Object(E.jsxs)(j.default,{style:{flexDirection:"row",alignItems:"center"},children:[Object(E.jsx)(b.default,{style:ie({flex:1},me.textfield),placeholder:"Beschreibung",onChangeText:I,value:W}),Object(E.jsx)(b.default,{style:ie({minWidth:50,marginLeft:5},me.textfield),placeholder:"0.00",keyboardType:"numeric",onChangeText:function(e){"string"===typeof e&&(e.match(/^[0123456789]*.*[0123456789]*$/)?(e=(e=(e=e.replace(/[^0123456789]/g,"").padStart(3,"0")).slice(0,e.length-2)+"."+e.slice(e.length-2)).replace("0"," ").trimStart().replace(" ","0").padStart(4,"0"),B(e)):(console.log("Ignored fool"),B("0.00")))},value:F}),Object(E.jsx)(f.default,{children:"\u20ac"})]}),Object(E.jsx)(Y,{onChange:K}),Object(E.jsx)(f.default,{children:"Beteiligte:"}),Object(E.jsx)(j.default,{style:{flexDirection:"row",margin:5,marginBottom:20,flexWrap:"wrap"},children:Object.values(r).map((function(e){var t=Object.keys(U).includes(String(e.id));return Object(E.jsxs)(g.default,{style:{flexDirection:"row",margin:5,height:60,minWidth:108,alignItems:"center",justifyContent:"space-evenly",backgroundColor:t?"#166b26":"white"},onPress:function(){G((function(t){var r=ie(ie({},t),{},i()({},e.id,e.id==a.user.id));return Object.keys(t).includes(String(e.id))&&delete r[e.id],r}))},children:[Object(E.jsx)(H,{imgUrl:k(e.profile_pic),imgSize:50,styleRing:{borderWidth:3,borderColor:"white"}}),Object(E.jsx)(f.default,{style:{color:t?"white":"black"},children:e.name})]},e.id)}))}),Object(E.jsx)(f.default,{children:"Anhang:"}),0==ee?Object(E.jsxs)(j.default,{style:{justifyContent:"space-evenly",flexDirection:"row"},children:[Object(E.jsx)(d.default,{title:"Kamera",color:"#166b26",onPress:c()((function*(){var e=yield Z.launchCameraAsync({quality:1,exif:!1,allowsEditing:!0});e.cancelled||te(e)}))}),Object(E.jsx)(d.default,{title:"Bibliothek",color:"#166b26",onPress:c()((function*(){var e=yield Z.launchImageLibraryAsync({quality:1,exif:!1,allowsEditing:!0});e.cancelled||te(e)}))})]}):Object(E.jsxs)(j.default,{children:[Object(E.jsx)(d.default,{title:"Entfernen",color:"red",onPress:function(){return te(!1)}}),Object(E.jsx)(D.default,{style:{flex:1,backgroundColor:"grey",minHeight:400},resizeMode:"center",source:{uri:ee.uri}})]}),Object(E.jsx)(j.default,{style:{borderBottomColor:"black",borderBottomWidth:u.default.hairlineWidth}}),Object(E.jsxs)(f.default,{children:["Du hast ",F,"\u20ac bezahlt."]}),Object(E.jsxs)(f.default,{children:["Du bekommst ",Object(E.jsx)(T,{amount:re/ne*oe})," von den ",oe," anderen Beteiligten zur\xfcck"]}),Object(E.jsx)(j.default,{style:{borderBottomColor:"black",borderBottomWidth:u.default.hairlineWidth,marginBottom:20}}),Object(E.jsx)(d.default,{title:"Senden",color:"#166b26",disabled:0!=v||!W||!re>0||ne<1,onPress:ae}),Object(E.jsx)(f.default,{children:JSON.stringify(O)})]})},Oe=function(e){var t=e.route.params.cost,n=Object(h.useContext)(_),i=l()(n,2),o=i[0],a=(i[1],A(o.user.id,t)),s=a.my_gain,d=a.single_payment,u=(a.amt,a.am_creditor),b=e.route.params.users,p=z("/api/my_wg/costs/"+t.id+"/shares",[],!1),O=l()(p,1)[0],m=new Date(t.added_on).toString(),y=Object(h.useState)([null,null]),x=l()(y,2),v=l()(x[0],2),w=v[0],S=v[1],P=x[1];Object(h.useEffect)((function(){(function(e,t){return he.apply(this,arguments)})(k(t.receit),o.token).then((function(e){console.log("Blob ready!"),P(e)}),(function(e){console.error("Couldn't get image blob:",e),P([{error:!0},null])}))}),[t.receit,o]);!function(){var e=c()((function*(){if(w&&!1!==w.error)if(yield ee.isAvailableAsync())try{yield ee.shareAsync(w,{dialogTitle:"Share Receit",mimeType:S})}catch(e){console.error("Couldn't share: ",e)}else console.error("Sharing Unavailable");else console.error("Blob nicht am start!")}))}();var W={headers:{Authorization:"Bearer "+o.token,Accept:"*/*","Accept-Encoding":"gzip, deflate, br"},method:"GET",uri:k(t.receit)};return console.log(W),Object(E.jsxs)(q.default,{children:[Object(E.jsx)(N,{cost:t,users:b},t.id),Object(E.jsxs)(j.default,{style:{margin:10},children:[Object(E.jsxs)(f.default,{children:["Datum: ",m]}),Object(E.jsx)(f.default,{style:{fontSize:20,marginTop:20,alignSelf:"stretch",backgroundColor:C,fontWeight:"bold",textAlign:"center"},children:"Anteile:"}),O.map((function(e){var r,n=b[String(e.debtor_id)]||{name:"????Ubkenannter Nuter?????"},i=e.paid?{textDecorationLine:"line-through",color:"grey"}:{};return r=t.my_share.debtor_id===e.debtor_id?Object(E.jsxs)(E.Fragment,{children:[Object(E.jsxs)(f.default,{style:i,children:[n.name," \xfcbernimmt "]}),Object(E.jsx)(T,{amount:-d,strikethrough:e.paid})]}):u?Object(E.jsxs)(E.Fragment,{children:[Object(E.jsxs)(f.default,{style:i,children:[n.name," \xfcbernimmt "]}),Object(E.jsx)(T,{amount:d,strikethrough:e.paid})]}):Object(E.jsxs)(E.Fragment,{children:[Object(E.jsxs)(f.default,{style:i,children:[n.name," \xfcbernimmt "]}),Object(E.jsx)(T,{amount:d,strikethrough:!0})]}),Object(E.jsxs)(j.default,{style:{flexDirection:"row",alignItems:"center"},children:[r,e.paid&&Object(E.jsx)(f.default,{children:" \u2714gezahlt"})]},e.debtor_id)})),Object(E.jsxs)(j.default,{style:{flexDirection:"row",alignItems:"center"},children:[Object(E.jsx)(f.default,{children:"Du bekommst/zahlst noch: "}),Object(E.jsx)(T,{amount:s})]}),t.receit&&t.receit.id&&Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)(f.default,{style:{fontSize:20,marginTop:20,alignSelf:"stretch",backgroundColor:C,fontWeight:"bold",textAlign:"center"},children:"Beleg:"}),Object(E.jsx)(g.default,{children:Object(E.jsx)(D.default,{style:{flex:1,backgroundColor:w&&!0===w.error?"red":"lightgray",minHeight:600},resizeMode:"center",loadingIndicatorSource:r(210),source:null==w?r(210):!0===w.error?{uri:k({})}:{uri:w},onError:function(e){return console.error("Failed loading image: ",e.nativeEvent,e.nativeEvent.error)},onLoad:function(){return console.log("Image pulled successfully.")}})})]})]})]})},me=u.default.create({textfield:{borderColor:"#12912a",borderWidth:2,borderRadius:10,padding:4,backgroundColor:"white"}});r(69);function ye(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function xe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ye(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ye(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ve=Object(y.default)();function we(){var e=Object(h.useState)(!1),t=l()(e,2),r=t[0],n=t[1],i=Object(h.useState)(!1),o=l()(i,2),a=o[0],s=o[1];function d(){return(d=c()((function*(e){try{var t=JSON.stringify(e);yield V.default.setItem("@login_data",t),console.log("Login Value saved!")}catch(r){console.error("Error saving value in AsyncStorage: ",r)}}))).apply(this,arguments)}console.log("APP LVL RD: ",r,a);var u=function(){var e=c()((function*(){try{var e=yield V.default.getItem("@login_data"),t=null!=e?JSON.parse(e):null;"object"==typeof t&&null!==t?(console.log("Successfully fetched login val!"),s(t)):(console.log("Successfully fetched the realization that user is logged out!"),n(!0))}catch(r){return console.error("Error getting login val: ",r),void n(!0)}}));return function(){return e.apply(this,arguments)}}();return Object(h.useEffect)((function(){a&&!r&&n(!0)}),[a,r]),Object(h.useEffect)((function(){u()}),[]),r?Object(E.jsx)(_.Provider,{value:[a,function(e){s((function(t){var r=e;return"function"==typeof e&&(console.log("Lmao function?"),r=e(t)),function(e){d.apply(this,arguments)}(r),r}))}],children:Object(E.jsx)(O.default,{children:0!=a?Object(E.jsx)(ze,{}):Object(E.jsx)(Ce,{})})}):Object(E.jsx)(j.default,{style:{flex:1,alignItems:"center",justifyContent:"center"},children:Object(E.jsx)(f.default,{children:"L\xe4dt login token..."})})}var Se=Object(x.default)();function Ce(){return Object(E.jsxs)(Se.Navigator,{initialRouteName:"Start",screenOptions:{header:function(){return!1}},children:[Object(E.jsx)(Se.Screen,{name:"Start",component:ke}),Object(E.jsx)(Se.Screen,{name:"ChooseWGUser",component:Pe}),Object(E.jsx)(Se.Screen,{name:"AsUser",component:_e})]})}function ke(e){var t=e.navigation,r=Object(h.useState)(""),n=l()(r,2),i=n[0],o=n[1];return console.log(i),Object(E.jsxs)(j.default,{style:De.container,children:[Object(E.jsx)(f.default,{style:{fontSize:32},children:"Hallo!"}),Object(E.jsx)(f.default,{children:"Gebe das K\xfcrzel deiner WG an..."}),Object(E.jsx)(b.default,{placeholder:"z.b. wg-von-heinz",style:De.input,value:i,onChangeText:o}),Object(E.jsx)(d.default,{title:"Anmelden",onPress:function(){return t.push("ChooseWGUser",{wg_url:i})}})]})}function _e(e){var t=Object(h.useState)(""),r=l()(t,2),n=r[0],i=r[1],o=Object(h.useState)(!1),a=l()(o,2),s=a[0],u=a[1],g=Object(h.useState)(null),p=l()(g,2),O=p[0],m=p[1],y=e.route.params.user||{},x=Object(h.useContext)(_),v=l()(x,2),w=(v[0],v[1]);return Object(E.jsxs)(j.default,{style:De.container,children:[Object(E.jsx)(H,{imgSize:200,style:De.headerImg,styleRing:{borderColor:"afb1cc",borderWidth:7},imgUrl:k(y.profile_pic)}),Object(E.jsxs)(f.default,{style:{fontSize:32},children:[y.name,Object(E.jsxs)(f.default,{style:{color:"rgba(0, 0, 0, 0.48)"},children:["- @",y.username]})," "]}),Object(E.jsx)(f.default,{children:O?"AHA! UNfug also? (Gab fehler:)\n"+O:"NA fug?! stimmt das denn auch? Gib mal Passwort ran jetzt"}),Object(E.jsx)(b.default,{placeholder:"darkest secret (i mean prlly one of the lightest actually)",style:De.input,value:n,onChangeText:i}),Object(E.jsx)(d.default,{disabled:s,title:"Anmelden",onPress:function(){var e=c()((function*(e){u(!0);try{var t=yield fetch(S+"/auth/login",{method:"POST",body:JSON.stringify({username:y.username,password:n}),headers:{"Content-Type":"application/json"}});if(t.ok){var r=yield t.json();console.log("LOGIN successful",r),w(xe(xe({},r),{},{user:y}))}else{var i=yield t.text();m(i)}}catch(o){m(o)}u(!1)}));return function(t){return e.apply(this,arguments)}}()})]})}function Pe(e){return Object(E.jsx)(J,xe({onUserPress:function(t){e.navigation.push("AsUser",{user:t})}},e))}function ze(){var e=z("/api/my_wg",{name:"WG",description:"Loading...",profile_pic:null,header_pic:null},{name:"FEHLER!!",description:"Konnte auf diese WG nicht zugreifen!"}),t=l()(e,1)[0],r=z("/api/my_wg/users",[],[{name:"FEHLER!",username:"Halt",id:-1}]),n=l()(r,1)[0],i={};return n.forEach((function(e){i[e.id]=e})),Object(E.jsx)(P.Provider,{value:{wg:t,users:i},children:Object(E.jsxs)(ve.Navigator,{screenOptions:{tabBarShowLabel:!1},children:[Object(E.jsx)(ve.Screen,{name:"Home",component:Ee,options:{tabBarIcon:function(e){var t=e.focused;return Object(E.jsx)(m.default,{name:"home",size:30,color:t?"#166b26":"#1d3522"})},headerShown:!1}}),Object(E.jsx)(ve.Screen,{name:"Finance",component:ce,options:{tabBarIcon:function(e){var t=e.focused;return Object(E.jsx)(m.default,{name:"money",size:30,color:t?"#166b26":"#1d3522"})},headerShown:!1}}),Object(E.jsx)(ve.Screen,{name:"Setting",component:We,options:{tabBarIcon:function(e){var t=e.focused;return Object(E.jsx)(m.default,{name:"gears",size:30,color:t?"#166b26":"#1d3522"})}}})]})})}var De=u.default.create({container:{flex:1,backgroundColor:"#fff",alignItems:"center",justifyContent:"center"},input:{borderColor:"#757575",borderRadius:10,borderWidth:2,padding:5,alignSelf:"stretch",margin:20}}),Ee=function(e){return Object(E.jsx)(J,xe({},e))};var We=function(e){var t=Object(h.useContext)(_),r=l()(t,2),n=(r[0],r[1]);return Object(E.jsxs)(j.default,{children:[Object(E.jsx)(f.default,{children:"Settings"}),Object(E.jsx)(d.default,{title:"ABMELDEN",color:"red",onPress:function(){n(!1)}})]})};function Ie(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ae(e){return Object(E.jsx)(we,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ie(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ie(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e))}},275:function(e,t,r){e.exports=r(397)}},[[275,1,2]]]);
//# sourceMappingURL=app.7d9fa28b.chunk.js.map